```mermaid
flowchart TD
  %% ===== Inputs =====
  subgraph IN[Inputs]
    A1[Raw RNA-seq data<br/>FASTQ (PE/SE)]
    A2[Reference genome<br/>FASTA (e.g., GRCh38)]
    A3[Gene annotation<br/>GTF (e.g., GENCODE)]
  end

  %% ===== Raw QC =====
  B[Raw data QC<br/>FastQC + MultiQC]

  %% ===== Pre-processing =====
  subgraph PRE[Pre-processing]
    C1[Trimming & filtering<br/>fastp]
    C2[Reference indexing<br/>STAR index / Salmon index]
  end

  %% ===== Quantification (two routes) =====
  subgraph Q[Expression quantification]
    direction LR

    subgraph RTA[Route A: Alignment-based]
      D1[Alignment<br/>STAR]
      D2[Gene-level quantification<br/>featureCounts / HTSeq-count]
      D1 --> D2
    end

    subgraph RTB[Route B: Alignment-free]
      E1[Quantification<br/>Salmon]
    end
  end

  %% ===== Count matrix =====
  F[Raw count matrix<br/>Gene Ã— Sample counts]

  %% ===== Stats =====
  subgraph STATS[Statistical analysis]
    G1[Differential expression<br/>DESeq2 / edgeR]
    G2[Sample QC & structure<br/>PCA / clustering / batch check]
  end

  %% ===== Visualization =====
  subgraph VIS[Visualization & interpretation]
    H1[Plots<br/>Volcano / heatmap / PCA (R)]
    H2[Genome browser<br/>IGV]
    H3[Biological interpretation (optional)<br/>GO/KEGG enrichment]
  end

  %% ===== Connections =====
  IN --> B --> C1 --> Q
  IN --> C2 --> Q
  Q --> F --> G1 --> VIS
  F --> G2 --> VIS

  %% ===== Styling (optional) =====
  classDef input fill:#E8F5E9,stroke:#2E7D32,stroke-width:1px;
  classDef process fill:#E3F2FD,stroke:#1565C0,stroke-width:1px;
  classDef output fill:#FFF3E0,stroke:#EF6C00,stroke-width:1px;

  class A1,A2,A3 input;
  class B,C1,C2,D1,D2,E1,G1,G2,H1,H2,H3 process;
  class F output;

```